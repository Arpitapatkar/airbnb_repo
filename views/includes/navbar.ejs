<style>
   .btn-search{
    background-color:#f2424d ;
    color:#fff;
    border-radius: 25px;
    padding: 0  0.8rem ;
    font-size: 0.9rem;
   }
   .btn-search:hover{
    background-color:#f2424d ;
    color:#fff;
   }
   .btn-search i{
    display:inline;
    margin-right: 0.5rem;
   }
  .search-input{
    border-radius: 25px;
    padding:0.5rem 3rem ;
    font-size: 0.9rem;
  }

</style>

<nav class="navbar navbar-expand-md bg-body-light border-bottom sticky-top">
  <div class="container-fluid">
    <a class="navbar-brand" href="/listings"><i class="fa-regular fa-compass"></i></i></a>
    <button 
        class="navbar-toggler" 
        type="button" 
        data-bs-toggle="collapse" 
        data-bs-target="#navbarNavAltMarkup" 
        aria-controls="navbarNavAltMarkup" 
        aria-expanded="false" 
        aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
      <div class="navbar-nav">
        <a class="nav-link" href="/listings">Explore</a>
        <!-- <a class="nav-link" id="findnearby" href="/listings/nearby">find nearby</a> -->
      </div>

      <div class="navbar-nav ms-auto">
        <form class="d-flex">
      <input 
           class="form-control me-2 search-input" 
           type="search" 
           placeholder="Search destination" 
           />
      <button class="btn btn-search" type="submit"><i class="fa-solid fa-magnifying-glass"></i>Search</button>
         </form>
      </div>

      <div class="navbar-nav ms-auto">
        <a class="nav-link" href="/listings/new">Airbnb your home</a>
        <% if (!currUser) { %>
           <a class="nav-link "  href="/signup"><b>Signup</b></a>
        <a class="nav-link" href="/login"><b>Log in</b></a>
       <% } %>
        <% if (currUser) { %>
        <a class="nav-link" href="/logout"><b>Logout</b></a>
        <% } %>
      </div>
    </div>
  </div>
</nav>


<!-- show nearby listings -->
<!-- <div class="modal fade" id="nearbyModal" tabindex="-1" aria-labelledby="nearbyModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-dark text-light">
        <h5 class="modal-title" id="nearbyModalLabel">Nearby Listings</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" id="nearby-modal-body">
        <p>Fetching nearby listings...</p>
      </div>
    </div>
  </div>
</div> -->

<script>
document.addEventListener("DOMContentLoaded", () => {
  const btn = document.getElementById("findnearby");
  if (!btn) return;

  btn.addEventListener("click", async (event) => {
    event.preventDefault(); // STOP PAGE FROM RELOADING

    if (!navigator.geolocation) {
      return alert("Your browser does not support location access.");
    }

    navigator.geolocation.getCurrentPosition(async (pos) => {
      const { latitude, longitude } = pos.coords;

      const res = await fetch(`/listings/nearby?lat=${latitude}&lon=${longitude}`);
      const data = await res.json();

      if (!data.length) {
        return alert("No nearby listings found within 5 km.");
      }

      let resultText = "Nearby Listings:\n\n";
      data.forEach(l => {
        resultText += `${l.title} - â‚¹${l.price} - ${l.location}\n`;
      });

      alert(resultText);

    }, 
    () => alert("Please allow location access to find nearby listings."));
  });
});
</script>







